<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BookShelf</title>
    <link rel="stylesheet" href="css/bookshelf.css">
    <script type="text/javascript" src="/eel.js"></script>
</head>
<body>
    <!-- Header Section -->
    <header>
        <div class="container">
            <div class="logo">
                <a href="index.html"><h1>BookHub</h1></a>
            </div>
            <nav>
                <ul>
                    <li><a href="bookstars.html">BookStars</a></li>
                    <li><a href="bookshelf.html">BookShelf</a></li>
                    <li><a href="borrow.html">Borrows</a></li>
                    <li><a href="account.html">Account</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Add Book Section -->
    <section class="add-book">
        <div class="container">
            <h2>Add New Book</h2>
            <form id="add-book-form">
                <label for="book-number">Book Number:</label>
                <input type="text" id="book-number" name="book-number" required>
                
                <label for="book-image">Book Image URL:</label>
                <input type="url" id="book-image" name="book-image" required>
                
                <label for="book-name">Book Name:</label>
                <input type="text" id="book-name" name="book-name" required>
                
                <label for="book-author">Author Name:</label>
                <input type="text" id="book-author" name="book-author" required>
                
                <button type="submit">Add Book</button>
            </form>
        </div>
    </section>

    <!-- Book List Section -->
    <section class="book-list">
        <div class="container">
            <h2>Available Books</h2>
            <!-- Library Grid for Horizontal Layout -->
            <div id="book-items-container" class="library-grid"></div>
        </div>
    </section>

    <script>
        window.onload = function () {
            const loggedIn = localStorage.getItem('loggedIn');
            const username = localStorage.getItem('username');
    
            if (loggedIn !== 'true' || !username) {
                window.location.href = 'login.html';
            }
        };
        document.addEventListener("DOMContentLoaded", function() {
            const addBookForm = document.getElementById('add-book-form');
            const bookItemsContainer = document.getElementById('book-items-container');

            // Existing book data
            const books = [
                { number: '1', image: 'https://via.placeholder.com/200x300', name: 'Book Title 1', author: 'Author Name' },
                { number: '2', image: 'https://via.placeholder.com/200x300', name: 'Book Title 2', author: 'Author Name' },
                { number: '3', image: 'https://via.placeholder.com/200x300', name: 'Book Title 3', author: 'Author Name' },
                { number: '4', image: 'https://via.placeholder.com/200x300', name: 'Book Title 4', author: 'Author Name' },
            ];

            // Function to render the book list
            function renderBooks() {
                bookItemsContainer.innerHTML = '';
                books.forEach((book, index) => {
                    const bookItem = document.createElement('div');
                    bookItem.classList.add('book-item');
                    bookItem.innerHTML = `
                        <img src="${book.image}" alt="${book.name}" class="book-image">
                        <h3>${book.name}</h3>
                        <p>Author: ${book.author}</p>
                        <p>Book No: ${book.number}</p>
                        <div class="button-container">
                            <button class="borrow-btn">Borrow</button>
                            <button class="edit-btn" data-index="${index}">Book Edit</button>
                        </div>
                    `;
                    bookItemsContainer.appendChild(bookItem);
                });

                // Attach edit event listeners
                const editButtons = document.querySelectorAll('.edit-btn');
                editButtons.forEach(button => {
                    button.addEventListener('click', function() {
                        const index = button.getAttribute('data-index');
                        const book = books[index];
                        document.getElementById('book-number').value = book.number;
                        document.getElementById('book-image').value = book.image;
                        document.getElementById('book-name').value = book.name;
                        document.getElementById('book-author').value = book.author;
                        addBookForm.dataset.editIndex = index;
                    });
                });
            }

            // Handle the form submission to add a new book or edit an existing one
            addBookForm.addEventListener('submit', function(event) {
                event.preventDefault();

                const bookNumber = document.getElementById('book-number').value;
                const bookImage = document.getElementById('book-image').value;
                const bookName = document.getElementById('book-name').value;
                const bookAuthor = document.getElementById('book-author').value;

                const newBook = { number: bookNumber, image: bookImage, name: bookName, author: bookAuthor };

                if (addBookForm.dataset.editIndex !== undefined) {
                    // Edit existing book
                    const editIndex = addBookForm.dataset.editIndex;
                    books[editIndex] = newBook;
                    delete addBookForm.dataset.editIndex;
                } else {
                    // Add new book
                    books.push(newBook);
                }

                addBookForm.reset();
                renderBooks();
            });

            // Initial render of books
            renderBooks();
        });
    </script>
</body>
</html>
